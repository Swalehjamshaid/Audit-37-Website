# nixpacks.toml – FULLY WORKING WeasyPrint on Railway (2025)
[phases.setup]
  nixLibs = [
    "glib",
    "gobject-introspection",
    "pango",
    "cairo",
    "gdk-pixbuf",
    "atk",
    "harfbuzz",
    "freetype",
    "fontconfig",
    "libjpeg",
    "libpng",
    "libwebp",
    "libxml2",
    "libxslt"
  ]

  aptPkgs = [
    "libgobject-2.0-0",          # ← THIS IS THE CRITICAL ONE
    "libglib2.0-0",
    "libglib2.0-dev",
    "libcairo2",
    "libcairo2-dev",
    "libpango-1.0-0",
    "libpango1.0-dev",
    "libgdk-pixbuf-2.0-0",
    "libgdk-pixbuf2.0-dev",
    "libatk1.0-0",
    "shared-mime-info"
  ]

# Only used by the website service
[start]
  cmd = "gunicorn app:app --bind 0.0.0.0:$PORT --workers 2 --timeout 180 --log-level info"
