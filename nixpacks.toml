# nixpacks.toml – fixes WeasyPrint on Railway forever
[phases.setup]
  nixLibs = [
    "glib", "pango", "cairo", "gdk-pixbuf", "atk", "gtk3",
    "libjpeg", "libpng", "freetype", "fontconfig", "harfbuzz",
    "libwebp", "libxml2", "libxslt", "zlib"
  ]
  aptPkgs = [
    "libgirepository-1.0-1",
    "libglib2.0-dev",
    "libcairo2-dev",
    "libpango1.0-dev",
    "libgdk-pixbuf2.0-dev",
    "shared-mime-info"
  ]

# This is only for the website service – worker/scheduler use their own commands
[start]
  cmd = "gunicorn app:app --bind 0.0.0.0:$PORT --workers 2 --timeout 180 --log-level info"
